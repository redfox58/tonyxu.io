(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{249:function(t,s,a){"use strict";a.r(s);var n=a(18),e=Object(n.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"创建alfred-workflow上传截图到s3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建alfred-workflow上传截图到s3","aria-hidden":"true"}},[t._v("#")]),t._v(" 创建Alfred Workflow上传截图到S3")]),t._v(" "),n("p",[t._v("Markdown语言正在变得越来越流行，大多数人在使用Markdown语言的时候都会需要粘贴图片，然而Markdown粘贴图片必须要用链接。今天我想向大家介绍如何创建一个Alfred workflow来自动上传你剪切板里的图片到S3并获取公开链接。")]),t._v(" "),n("h2",{attrs:{id:"演示"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#演示","aria-hidden":"true"}},[t._v("#")]),t._v(" 演示")]),t._v(" "),n("p",[n("img",{attrs:{src:a(380),alt:"2018-07-08+21_33_30.gif"}})]),t._v(" "),n("h2",{attrs:{id:"主要步骤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#主要步骤","aria-hidden":"true"}},[t._v("#")]),t._v(" 主要步骤")]),t._v(" "),n("ol",[n("li",[t._v("使用 "),n("code",[t._v("pngpaste")]),t._v(" 获取剪切板图片")]),t._v(" "),n("li",[t._v("把图片写到临时文件夹 "),n("code",[t._v("/tmp")])]),t._v(" "),n("li",[t._v("使用"),n("code",[t._v("boto3")]),t._v("上传图片到AWS S3")])]),t._v(" "),n("h2",{attrs:{id:"实现"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实现","aria-hidden":"true"}},[t._v("#")]),t._v(" 实现")]),t._v(" "),n("p",[t._v("现在我们知道主要步骤，接下来就是编写Alfred Workflow的Python脚本实现了。")]),t._v(" "),n("h3",{attrs:{id:"创建-alfred-workflow"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建-alfred-workflow","aria-hidden":"true"}},[t._v("#")]),t._v(" 创建 Alfred workflow")]),t._v(" "),n("p",[t._v("创建 "),n("code",[t._v("Blank Workflow")]),t._v(" 并命名")]),t._v(" "),n("p",[t._v("右键空白区域并选择"),n("code",[t._v("Inputs -> Keyword")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(381),alt:"2018_07_08_20_56_57.png"}})]),t._v(" "),n("p",[t._v("指定触发workflow的关键词")]),t._v(" "),n("p",[n("img",{attrs:{src:a(382),alt:"2018_07_08_20_50_57.png"}})]),t._v(" "),n("p",[t._v("右键空白区域并选择"),n("code",[t._v("Actions -> Run Script")])]),t._v(" "),n("p",[t._v("让我们让它执行Python脚本")]),t._v(" "),n("p",[n("img",{attrs:{src:a(383),alt:"2018_07_08_20_58_41.png"}})]),t._v(" "),n("p",[t._v("点击"),n("code",[t._v("Cancel")]),t._v("左侧的按钮来打开workflow文件夹")]),t._v(" "),n("p",[t._v("创建脚本文件(确保文件名和你在上面步骤制定的脚本名一致, 并按照如下所述编写脚本")]),t._v(" "),n("div",{staticClass:"language-python line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#!/usr/bin/python")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# -*- coding: utf-8 -*-")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" __future__ "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" print_function\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" datetime\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" os\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" sys\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" atexit\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" imghdr\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" subprocess "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" call\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" expanduser"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exists"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" basename"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" getsize\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" workflow "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Workflow\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("capture")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    file_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" datetime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("datetime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("now"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("strftime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%Y_%m_%d_%H_%M_%S.png'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    file_path "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("join"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/tmp'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    atexit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("register"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("lambda")]),t._v(" x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("remove"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exists"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file_path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    save "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" call"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./pngpaste'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file_path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" save "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Quit job if no image found in clipboard")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"No image found in clipboard"')]),t._v("\n        sys"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" file_path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file_name\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" boto3\n    file_path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" capture"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    bucket_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getenv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bucket_name'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    s3 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" boto3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'s3'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        aws_access_key_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getenv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'access_key'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        aws_secret_access_key"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getenv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'secret_key'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    s3"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("upload_file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file_path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bucket_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ExtraArgs"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ContentType'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"image/png"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    output "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"%s/%s"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getenv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bucket_uri'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" file_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("end"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__main__'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    wf "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Workflow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("libraries"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./lib'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    sys"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("main"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br")])]),n("p",[t._v("这个脚本会返回图片的公开链接，我们可以通过系统推送通知用户链接已经生成成功")]),t._v(" "),n("p",[t._v("右键空白区域，并选择 "),n("code",[t._v("Outputs –> Copy to Clipboard")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(384),alt:"2018_07_08_21_06_32.png"}})]),t._v(" "),n("p",[t._v("右键空白区域，并选择 "),n("code",[t._v("Outputs –> Post Notification")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(385),alt:"2018_07_08_21_06_54.png"}})]),t._v(" "),n("p",[t._v("接下来，像我一样连接这些盒子:")]),t._v(" "),n("p",[n("img",{attrs:{src:a(386),alt:"2018_07_08_21_07_52.png"}})]),t._v(" "),n("h3",{attrs:{id:"添加第三方库"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加第三方库","aria-hidden":"true"}},[t._v("#")]),t._v(" 添加第三方库")]),t._v(" "),n("p",[t._v("在脚本中，我们用到了如下第三方库，需要确保workflow可以访问")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://alfredworkflow.readthedocs.io/en/latest/installation.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Workflow"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://docs.aws.amazon.com/cli/latest/userguide/installing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("awscli"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://boto3.readthedocs.io/en/latest/guide/quickstart.html#installation",target:"_blank",rel:"noopener noreferrer"}},[t._v("boto3"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/jcsalterego/pngpaste",target:"_blank",rel:"noopener noreferrer"}},[t._v("pngpaste"),n("OutboundLink")],1)])]),t._v(" "),n("p",[t._v("安装第三方库:")]),t._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("pip install --target=/path/to/workflow Alfred-Workflow\npip install --target=/path/to/workflow/lib awscli\npip install --target=/path/to/workflow/lib boto3\nbrew install pngpaste\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("p",[t._v("请注意pngpaste命令行工具的二进制文件需要被复制到"),n("code",[t._v("/path/to/workflow")]),t._v(".")]),t._v(" "),n("h3",{attrs:{id:"添加环境变量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加环境变量","aria-hidden":"true"}},[t._v("#")]),t._v(" 添加环境变量")]),t._v(" "),n("p",[t._v("在脚本中，我们用到了这些环境变量:")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("access_key: S3 access key")])]),t._v(" "),n("li",[n("p",[t._v("secret_key: S3 access secret")])]),t._v(" "),n("li",[n("p",[t._v("bucket_name: S3 bucket 名. 例如 "),n("code",[t._v("my-bucket-name")])])]),t._v(" "),n("li",[n("p",[t._v("bucket_uri: S3 bucket URI 不含结尾斜杠. 例如 "),n("code",[t._v("https://s3-us-west-1.amazonaws.com/my-bucket-name")])])])]),t._v(" "),n("p",[t._v("添加并配置到环境变量设置:")]),t._v(" "),n("p",[n("img",{attrs:{src:a(387),alt:"2018_07_10_20_55_19.png"}})]),t._v(" "),n("p",[t._v("如果你还没有access key 和 secret, 跟随教程创建他们:\n"),n("a",{attrs:{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html#Using_CreateAccessKey",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html#Using_CreateAccessKey"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("确保用户可以读写S3 bucket.")]),t._v(" "),n("h2",{attrs:{id:"完成"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#完成","aria-hidden":"true"}},[t._v("#")]),t._v(" 完成")]),t._v(" "),n("p",[t._v("恭喜，你已经完成。现在可以尝试了。")]),t._v(" "),n("h2",{attrs:{id:"拓展"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#拓展","aria-hidden":"true"}},[t._v("#")]),t._v(" 拓展")]),t._v(" "),n("p",[t._v("你可能会想添加支持上传任意本地图片到S3, 推荐你自己尝试实现它。")]),t._v(" "),n("p",[t._v("下载参考源码:")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/tonyxu-io/Alfred-Workflow-Upload-S3",target:"_blank",rel:"noopener noreferrer"}},[t._v("tonyxu-io/Alfred-Workflow-Upload-S3"),n("OutboundLink")],1)]),t._v(" "),n("p",[t._v("参考资料:")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://xfyuan.github.io/2017/03/use-alfred-to-auto-upload-screenshot-to-qiniu-and-generate-the-markdown-image-url/",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 Alfred workflow 上传截图到七牛并自动生成外链URL"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"http://labmain.com/2016/04/06/A_Alfred_Workflow_upload_clipboard%27image_to_qiniu/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Alfred Workflow —— 上传剪贴板的图片到七牛"),n("OutboundLink")],1)])])])},[],!1,null,null,null);e.options.__file="README.md";s.default=e.exports},380:function(t,s,a){t.exports=a.p+"assets/img/2018-07-08+21_33_30.62122585.gif"},381:function(t,s,a){t.exports=a.p+"assets/img/2018_07_08_20_56_57.730b4a91.png"},382:function(t,s,a){t.exports=a.p+"assets/img/2018_07_08_20_50_57.183dcb26.png"},383:function(t,s,a){t.exports=a.p+"assets/img/2018_07_08_20_58_41.ec3a9343.png"},384:function(t,s,a){t.exports=a.p+"assets/img/2018_07_08_21_06_32.5e73e58d.png"},385:function(t,s,a){t.exports=a.p+"assets/img/2018_07_08_21_06_54.58c8e1ab.png"},386:function(t,s,a){t.exports=a.p+"assets/img/2018_07_08_21_07_52.7ad2dab2.png"},387:function(t,s,a){t.exports=a.p+"assets/img/2018_07_10_20_55_19.d56bccf5.png"}}]);